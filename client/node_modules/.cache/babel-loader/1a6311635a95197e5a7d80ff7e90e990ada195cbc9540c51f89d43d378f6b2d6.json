{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\melkote\\\\Downloads\\\\NearFinalProjectBACSHOTSONME123-main\\\\NearFinalProjectBACSHOTSONME123-main\\\\client\\\\src\\\\pages\\\\Home.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState, useMemo } from 'react';\nimport './Home.css';\nimport { getAllUserLogs, getUserAchievements, updateDrinkingLog } from '../api';\nimport Navbar from '../components/Navbar';\n\n/**\n * Helper function to format a Date object as a local YYYY-MM-DD string.\n * We force the time to noon (12:00) to normalize differences.\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction formatLocalDate(date) {\n  const d = new Date(date.getTime());\n  d.setHours(12, 0, 0, 0);\n  const year = d.getFullYear();\n  const month = String(d.getMonth() + 1).padStart(2, '0'); // months are 0-based\n  const day = String(d.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\n/**\n * Helper: Count how many \"sober\" or \"medium\" days in the last 7 days,\n * shifting each log's date back by one day to correct for the calendar being one day ahead.\n */\nfunction computeWeeklySoberDays(allLogs) {\n  const now = new Date();\n  now.setHours(12, 0, 0, 0);\n  const start = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n  let count = 0;\n  allLogs.forEach(log => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    // Shift back one day so that a log recorded as Sunday is treated as Saturday, etc.\n    d.setDate(d.getDate() - 2);\n    if (d >= start && d <= now && (log.status === 'sober' || log.status === 'medium')) {\n      count++;\n    }\n  });\n  return count;\n}\n\n/**\n * Helper: Count how many months (in the last 12) had no \"heavy\" logs,\n * shifting each log's date back by one day to correct for the calendar being one day ahead.\n */\nfunction computeMonthsNoCrash(allLogs) {\n  const map = {};\n  const now = new Date();\n  now.setHours(12, 0, 0, 0);\n  const last12 = new Date(now.getFullYear(), now.getMonth() - 12, now.getDate(), 0);\n  allLogs.forEach(log => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    // Shift back one day for achievement calculations.\n    d.setDate(d.getDate() - 1);\n    if (d >= last12 && d <= now) {\n      const ym = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;\n      if (!map[ym]) map[ym] = false;\n      if (log.status === 'heavy') {\n        map[ym] = true;\n      }\n    }\n  });\n  let count = 0;\n  Object.values(map).forEach(val => {\n    if (val === false) count++;\n  });\n  return count;\n}\n\n/**\n * Reusable Modal component for smooth transitions.\n * When the overlay is clicked, it triggers a fade-out/scale-out animation,\n * then calls onClose() after 300ms.\n */\nfunction Modal({\n  children,\n  onClose\n}) {\n  _s();\n  const [closing, setClosing] = useState(false);\n  const handleClose = () => {\n    setClosing(true);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `modal-overlay ${closing ? 'fade-out' : 'fade-in'}`,\n    onClick: handleClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `modal-content large-modal ${closing ? 'scale-out' : 'scale-in'}`,\n      onClick: e => e.stopPropagation(),\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(Modal, \"siUBsXlDiREAn0hWnbur2taSF6s=\");\n_c = Modal;\nexport default function Home() {\n  _s2();\n  const cachedLogs = localStorage.getItem('cachedLogs');\n  const cachedAch = localStorage.getItem('cachedAchievements');\n  const storedUserStr = localStorage.getItem('bacshotsUser');\n  const user = storedUserStr ? JSON.parse(storedUserStr) : null;\n  const initials = user && user.name ? user.name.split(' ').reduce((acc, cur, idx, arr) => {\n    if (idx === 0 || idx === arr.length - 1) return acc + cur[0];\n    return acc;\n  }, '').toUpperCase() : 'N';\n  const profileUrl = user === null || user === void 0 ? void 0 : user.profilePicture;\n  const firstName = user !== null && user !== void 0 && user.name ? user.name.split(' ')[0] : '';\n  const [allLogs, setAllLogs] = useState(cachedLogs ? JSON.parse(cachedLogs) : []);\n  const [achievements, setAchievements] = useState(cachedAch ? JSON.parse(cachedAch) : []);\n  const nowDate = new Date();\n  const [currentYear, setCurrentYear] = useState(nowDate.getFullYear());\n  const [currentMonth, setCurrentMonth] = useState(nowDate.getMonth() + 1);\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [isDayPanelOpen, setIsDayPanelOpen] = useState(false);\n  const [weeklyModalOpen, setWeeklyModalOpen] = useState(false);\n  const [monthlyModalOpen, setMonthlyModalOpen] = useState(false);\n  const [achievementsModalOpen, setAchievementsModalOpen] = useState(false);\n  useEffect(() => {\n    if (!(user !== null && user !== void 0 && user._id)) return;\n    (async () => {\n      try {\n        const resLogs = await getAllUserLogs(user._id);\n        if (resLogs && resLogs.success) {\n          setAllLogs(resLogs.logs);\n          localStorage.setItem('cachedLogs', JSON.stringify(resLogs.logs));\n        }\n      } catch (err) {\n        console.error(\"Error fetching logs:\", err);\n      }\n      try {\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      } catch (err) {\n        console.error(\"Error fetching achievements:\", err);\n      }\n    })();\n  }, [user]);\n\n  // Filter logs for the current month.\n  const monthLogs = useMemo(() => {\n    return allLogs.filter(log => {\n      const d = new Date(log.date);\n      return d.getFullYear() === currentYear && d.getMonth() + 1 === currentMonth;\n    });\n  }, [allLogs, currentYear, currentMonth]);\n\n  // Build logsMap using normalized local date strings for calendar display.\n  const logsMap = useMemo(() => {\n    const map = {};\n    monthLogs.forEach(log => {\n      const d = new Date(log.date);\n      d.setHours(12, 0, 0, 0);\n      const key = formatLocalDate(d);\n      map[key] = log.status;\n    });\n    return map;\n  }, [monthLogs]);\n\n  // getDayClass uses the normalized date string for calendar display.\n  const getDayClass = dateObj => {\n    if (!dateObj) return 'day-cell day-outside';\n    const d = new Date(dateObj);\n    d.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(d);\n    let statusClass = '';\n    if (logsMap[key] === 'sober') statusClass = 'day-sober';\n    if (logsMap[key] === 'medium') statusClass = 'day-medium';\n    if (logsMap[key] === 'heavy') statusClass = 'day-heavy';\n    if (selectedDate) {\n      const sel = new Date(selectedDate);\n      sel.setHours(12, 0, 0, 0);\n      if (formatLocalDate(sel) === key) {\n        return `day-cell ${statusClass} day-selected`;\n      }\n    }\n    return `day-cell ${statusClass}`;\n  };\n\n  // Shift log dates back by one day when calculating achievements.\n  const weeklySoberDays = useMemo(() => computeWeeklySoberDays(allLogs), [allLogs]);\n  const monthsCrashoutFree = useMemo(() => computeMonthsNoCrash(allLogs), [allLogs]);\n  const totalAchievements = 9;\n  const unlockedCount = achievements.reduce((acc, a) => a.unlocked ? acc + 1 : acc, 0);\n  const fraction = Math.min(unlockedCount / totalAchievements, 1);\n\n  // Build an array of dates for the current month.\n  // The calendar display remains unchanged.\n  const getDaysArray = (year, month) => {\n    const firstDow = new Date(year, month - 1, 1, 12).getDay();\n    const lastDay = new Date(year, month, 0).getDate();\n    const arr = [];\n    for (let i = 0; i < firstDow; i++) {\n      arr.push(null);\n    }\n    for (let d = 1; d <= lastDay; d++) {\n      arr.push(new Date(year, month - 1, d, 12));\n    }\n    return arr;\n  };\n  const daysArray = getDaysArray(currentYear, currentMonth);\n  const handleDayClick = dateObj => {\n    if (!dateObj) return;\n    // Prevent clicking on dates in the future if viewing the current month.\n    const clickedDate = new Date(dateObj);\n    clickedDate.setHours(12, 0, 0, 0);\n    const today = new Date();\n    today.setHours(12, 0, 0, 0);\n    if (currentYear === today.getFullYear() && currentMonth === today.getMonth() + 1) {\n      if (clickedDate > today) return;\n    }\n    if (selectedDate && selectedDate.getTime() === dateObj.getTime()) {\n      setIsDayPanelOpen(false);\n      setTimeout(() => setSelectedDate(null), 300);\n    } else {\n      setSelectedDate(dateObj);\n      setIsDayPanelOpen(true);\n    }\n  };\n\n  // When updating a day's status, normalize the date before storing.\n  const handleUpdateStatus = async status => {\n    if (!selectedDate || !(user !== null && user !== void 0 && user._id)) return;\n    const normalizedDate = new Date(selectedDate);\n    normalizedDate.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(normalizedDate);\n    try {\n      const res = await updateDrinkingLog(user._id, key, status);\n      if (res && res.success) {\n        setAllLogs(prev => {\n          const idx = prev.findIndex(lg => {\n            const dd = new Date(lg.date);\n            dd.setHours(12, 0, 0, 0);\n            return formatLocalDate(dd) === key;\n          });\n          if (idx >= 0) {\n            const newArr = [...prev];\n            newArr[idx].status = status;\n            return newArr;\n          } else {\n            return [...prev, {\n              user: user._id,\n              date: normalizedDate,\n              status\n            }];\n          }\n        });\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      }\n    } catch (err) {\n      console.error(\"Error updating day log:\", err);\n    }\n  };\n  const handlePrevMonth = () => {\n    let mo = currentMonth - 1;\n    let yr = currentYear;\n    if (mo < 1) {\n      mo = 12;\n      yr--;\n    }\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n  const handleNextMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    let mo = currentMonth + 1;\n    let yr = currentYear;\n    if (mo > 12) {\n      mo = 1;\n      yr++;\n    }\n    if (yr > realY || yr === realY && mo > realM) return;\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n  const isCurrentMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    return currentYear === realY && currentMonth === realM;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home-container\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {\n      onSignOut: () => {\n        localStorage.removeItem('bacshotsUser');\n        window.location.href = '/signin';\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"home-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"big-profile-container\",\n        children: profileUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: profileUrl,\n          alt: \"Profile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"big-profile-initials\",\n          children: initials || 'N'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"greeting dm-sans-semibold\",\n        children: [\"Hello \", firstName, \"!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stats-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-box dm-sans-semibold\",\n          onClick: () => setWeeklyModalOpen(true),\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Your Weekly \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 28\n            }, this), \" Stats\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"stats-subtext\",\n            children: [weeklySoberDays, \" days sober this week\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-box dm-sans-semibold\",\n          onClick: () => setMonthlyModalOpen(true),\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Your Monthly Stats\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"stats-subtext\",\n            children: [monthsCrashoutFree, \" crashout\\u2011free months\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-box dm-sans-semibold achievements-box\",\n          onClick: () => setAchievementsModalOpen(true),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"achievements-ring\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"progress-ring\",\n              width: \"120\",\n              height: \"120\",\n              children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                stroke: \"#ccc\",\n                strokeWidth: \"10\",\n                fill: \"transparent\",\n                r: 50,\n                cx: \"60\",\n                cy: \"60\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                stroke: \"#4caf50\",\n                strokeWidth: \"10\",\n                fill: \"transparent\",\n                r: 50,\n                cx: \"60\",\n                cy: \"60\",\n                strokeDasharray: `${2 * Math.PI * 50} ${2 * Math.PI * 50}`,\n                strokeDashoffset: 2 * Math.PI * 50 - fraction * (2 * Math.PI * 50),\n                style: {\n                  transition: 'stroke-dashoffset 0.5s ease'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n                x: \"60\",\n                y: \"66\",\n                textAnchor: \"middle\",\n                fontSize: \"20\",\n                fontWeight: \"bold\",\n                fill: \"#333\",\n                children: [unlockedCount, \"/\", totalAchievements]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Achievements\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"calendar-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"cal-nav-btn\",\n            onClick: handlePrevMonth,\n            children: \"\\u2039\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"calendar-month-year dm-sans-semibold\",\n            children: [currentMonth, \"/\", currentYear]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this), !isCurrentMonth() && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"cal-nav-btn\",\n            onClick: handleNextMonth,\n            children: \"\\u203A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-grid day-labels\",\n          children: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(d => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"day-label\",\n            children: d\n          }, d, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendar-grid day-cells\",\n          children: daysArray.map((dt, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: getDayClass(dt),\n            onClick: () => handleDayClick(dt),\n            children: dt ? dt.getDate() : ''\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `day-status-panel ${selectedDate && isDayPanelOpen ? 'open' : selectedDate ? 'opening' : 'closing'}`,\n        children: selectedDate && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"day-status-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-sober\",\n            onClick: () => handleUpdateStatus('sober'),\n            children: \"I did not drink\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-medium\",\n            onClick: () => handleUpdateStatus('medium'),\n            children: \"I drank a bit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-heavy\",\n            onClick: () => handleUpdateStatus('heavy'),\n            children: \"I crashed out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), weeklyModalOpen && /*#__PURE__*/_jsxDEV(Modal, {\n      onClose: () => setWeeklyModalOpen(false),\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"dm-sans-semibold\",\n        children: \"Weekly Stats\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You have been sober \", weeklySoberDays, \" days this week!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Additional charts can be shown here.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 9\n    }, this), monthlyModalOpen && /*#__PURE__*/_jsxDEV(Modal, {\n      onClose: () => setMonthlyModalOpen(false),\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"dm-sans-semibold\",\n        children: \"Monthly Stats\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You have \", monthsCrashoutFree, \" crashout\\u2011free months in the last 12 months.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Additional monthly details can be shown here.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 9\n    }, this), achievementsModalOpen && /*#__PURE__*/_jsxDEV(Modal, {\n      onClose: () => setAchievementsModalOpen(false),\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"dm-sans-semibold\",\n        children: \"Achievements\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Below are your achievements. A \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"achievement-status unlocked\",\n          children: \"\\u2713\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 44\n        }, this), \" indicates you\\u2019ve accomplished it, while a \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"achievement-status locked\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 141\n        }, this), \" indicates you haven\\u2019t.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"achievement-list\",\n        children: achievements.map(ach => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"achievement-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: ach.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 19\n            }, this), \" \\u2013 \", ach.description]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `achievement-status ${ach.unlocked ? 'unlocked' : 'locked'}`,\n            children: ach.unlocked ? '✓' : '✕'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 17\n          }, this)]\n        }, ach.key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 301,\n    columnNumber: 5\n  }, this);\n}\n_s2(Home, \"lsVO7ngIl2p2yxLkUn3KtI3YWzQ=\");\n_c2 = Home;\nvar _c, _c2;\n$RefreshReg$(_c, \"Modal\");\n$RefreshReg$(_c2, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","getAllUserLogs","getUserAchievements","updateDrinkingLog","Navbar","jsxDEV","_jsxDEV","formatLocalDate","date","d","Date","getTime","setHours","year","getFullYear","month","String","getMonth","padStart","day","getDate","computeWeeklySoberDays","allLogs","now","start","count","forEach","log","setDate","status","computeMonthsNoCrash","map","last12","ym","Object","values","val","Modal","children","onClose","_s","closing","setClosing","handleClose","setTimeout","className","onClick","e","stopPropagation","fileName","_jsxFileName","lineNumber","columnNumber","_c","Home","_s2","cachedLogs","localStorage","getItem","cachedAch","storedUserStr","user","JSON","parse","initials","name","split","reduce","acc","cur","idx","arr","length","toUpperCase","profileUrl","profilePicture","firstName","setAllLogs","achievements","setAchievements","nowDate","currentYear","setCurrentYear","currentMonth","setCurrentMonth","selectedDate","setSelectedDate","isDayPanelOpen","setIsDayPanelOpen","weeklyModalOpen","setWeeklyModalOpen","monthlyModalOpen","setMonthlyModalOpen","achievementsModalOpen","setAchievementsModalOpen","_id","resLogs","success","logs","setItem","stringify","err","console","error","resAch","monthLogs","filter","logsMap","key","getDayClass","dateObj","statusClass","sel","weeklySoberDays","monthsCrashoutFree","totalAchievements","unlockedCount","a","unlocked","fraction","Math","min","getDaysArray","firstDow","getDay","lastDay","i","push","daysArray","handleDayClick","clickedDate","today","handleUpdateStatus","normalizedDate","res","prev","findIndex","lg","dd","newArr","handlePrevMonth","mo","yr","handleNextMonth","realY","realM","isCurrentMonth","onSignOut","removeItem","window","location","href","src","alt","width","height","stroke","strokeWidth","fill","r","cx","cy","strokeDasharray","PI","strokeDashoffset","style","transition","x","y","textAnchor","fontSize","fontWeight","dt","ach","description","_c2","$RefreshReg$"],"sources":["C:/Users/melkote/Downloads/NearFinalProjectBACSHOTSONME123-main/NearFinalProjectBACSHOTSONME123-main/client/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react';\nimport './Home.css';\nimport {\n  getAllUserLogs,\n  getUserAchievements,\n  updateDrinkingLog\n} from '../api';\nimport Navbar from '../components/Navbar';\n\n/**\n * Helper function to format a Date object as a local YYYY-MM-DD string.\n * We force the time to noon (12:00) to normalize differences.\n */\nfunction formatLocalDate(date) {\n  const d = new Date(date.getTime());\n  d.setHours(12, 0, 0, 0);\n  const year = d.getFullYear();\n  const month = String(d.getMonth() + 1).padStart(2, '0'); // months are 0-based\n  const day = String(d.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\n/**\n * Helper: Count how many \"sober\" or \"medium\" days in the last 7 days,\n * shifting each log's date back by one day to correct for the calendar being one day ahead.\n */\nfunction computeWeeklySoberDays(allLogs) {\n  const now = new Date();\n  now.setHours(12, 0, 0, 0);\n  const start = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n  let count = 0;\n  allLogs.forEach((log) => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    // Shift back one day so that a log recorded as Sunday is treated as Saturday, etc.\n    d.setDate(d.getDate() - 2);\n    if (d >= start && d <= now && (log.status === 'sober' || log.status === 'medium')) {\n      count++;\n    }\n  });\n  return count;\n}\n\n/**\n * Helper: Count how many months (in the last 12) had no \"heavy\" logs,\n * shifting each log's date back by one day to correct for the calendar being one day ahead.\n */\nfunction computeMonthsNoCrash(allLogs) {\n  const map = {};\n  const now = new Date();\n  now.setHours(12, 0, 0, 0);\n  const last12 = new Date(now.getFullYear(), now.getMonth() - 12, now.getDate(), 0);\n  allLogs.forEach((log) => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    // Shift back one day for achievement calculations.\n    d.setDate(d.getDate() - 1);\n    if (d >= last12 && d <= now) {\n      const ym = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;\n      if (!map[ym]) map[ym] = false;\n      if (log.status === 'heavy') {\n        map[ym] = true;\n      }\n    }\n  });\n  let count = 0;\n  Object.values(map).forEach((val) => {\n    if (val === false) count++;\n  });\n  return count;\n}\n\n/**\n * Reusable Modal component for smooth transitions.\n * When the overlay is clicked, it triggers a fade-out/scale-out animation,\n * then calls onClose() after 300ms.\n */\nfunction Modal({ children, onClose }) {\n  const [closing, setClosing] = useState(false);\n  const handleClose = () => {\n    setClosing(true);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n  return (\n    <div className={`modal-overlay ${closing ? 'fade-out' : 'fade-in'}`} onClick={handleClose}>\n      <div className={`modal-content large-modal ${closing ? 'scale-out' : 'scale-in'}`} onClick={(e) => e.stopPropagation()}>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nexport default function Home() {\n  const cachedLogs = localStorage.getItem('cachedLogs');\n  const cachedAch = localStorage.getItem('cachedAchievements');\n  const storedUserStr = localStorage.getItem('bacshotsUser');\n  const user = storedUserStr ? JSON.parse(storedUserStr) : null;\n  \n  const initials = user && user.name \n    ? user.name.split(' ').reduce((acc, cur, idx, arr) => {\n        if (idx === 0 || idx === arr.length - 1) return acc + cur[0];\n        return acc;\n      }, '').toUpperCase()\n    : 'N';\n  const profileUrl = user?.profilePicture;\n  const firstName = user?.name ? user.name.split(' ')[0] : '';\n\n  const [allLogs, setAllLogs] = useState(cachedLogs ? JSON.parse(cachedLogs) : []);\n  const [achievements, setAchievements] = useState(cachedAch ? JSON.parse(cachedAch) : []);\n  const nowDate = new Date();\n  const [currentYear, setCurrentYear] = useState(nowDate.getFullYear());\n  const [currentMonth, setCurrentMonth] = useState(nowDate.getMonth() + 1);\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [isDayPanelOpen, setIsDayPanelOpen] = useState(false);\n  const [weeklyModalOpen, setWeeklyModalOpen] = useState(false);\n  const [monthlyModalOpen, setMonthlyModalOpen] = useState(false);\n  const [achievementsModalOpen, setAchievementsModalOpen] = useState(false);\n\n  useEffect(() => {\n    if (!user?._id) return;\n    (async () => {\n      try {\n        const resLogs = await getAllUserLogs(user._id);\n        if (resLogs && resLogs.success) {\n          setAllLogs(resLogs.logs);\n          localStorage.setItem('cachedLogs', JSON.stringify(resLogs.logs));\n        }\n      } catch (err) {\n        console.error(\"Error fetching logs:\", err);\n      }\n      try {\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      } catch (err) {\n        console.error(\"Error fetching achievements:\", err);\n      }\n    })();\n  }, [user]);\n\n  // Filter logs for the current month.\n  const monthLogs = useMemo(() => {\n    return allLogs.filter((log) => {\n      const d = new Date(log.date);\n      return d.getFullYear() === currentYear && d.getMonth() + 1 === currentMonth;\n    });\n  }, [allLogs, currentYear, currentMonth]);\n\n  // Build logsMap using normalized local date strings for calendar display.\n  const logsMap = useMemo(() => {\n    const map = {};\n    monthLogs.forEach((log) => {\n      const d = new Date(log.date);\n      d.setHours(12, 0, 0, 0);\n      const key = formatLocalDate(d);\n      map[key] = log.status;\n    });\n    return map;\n  }, [monthLogs]);\n\n  // getDayClass uses the normalized date string for calendar display.\n  const getDayClass = (dateObj) => {\n    if (!dateObj) return 'day-cell day-outside';\n    const d = new Date(dateObj);\n    d.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(d);\n    let statusClass = '';\n    if (logsMap[key] === 'sober') statusClass = 'day-sober';\n    if (logsMap[key] === 'medium') statusClass = 'day-medium';\n    if (logsMap[key] === 'heavy') statusClass = 'day-heavy';\n    if (selectedDate) {\n      const sel = new Date(selectedDate);\n      sel.setHours(12, 0, 0, 0);\n      if (formatLocalDate(sel) === key) {\n        return `day-cell ${statusClass} day-selected`;\n      }\n    }\n    return `day-cell ${statusClass}`;\n  };\n\n  // Shift log dates back by one day when calculating achievements.\n  const weeklySoberDays = useMemo(() => computeWeeklySoberDays(allLogs), [allLogs]);\n  const monthsCrashoutFree = useMemo(() => computeMonthsNoCrash(allLogs), [allLogs]);\n\n  const totalAchievements = 9;\n  const unlockedCount = achievements.reduce((acc, a) => (a.unlocked ? acc + 1 : acc), 0);\n  const fraction = Math.min(unlockedCount / totalAchievements, 1);\n\n  // Build an array of dates for the current month.\n  // The calendar display remains unchanged.\n  const getDaysArray = (year, month) => {\n    const firstDow = new Date(year, month - 1, 1, 12).getDay();\n    const lastDay = new Date(year, month, 0).getDate();\n    const arr = [];\n    for (let i = 0; i < firstDow; i++) {\n      arr.push(null);\n    }\n    for (let d = 1; d <= lastDay; d++) {\n      arr.push(new Date(year, month - 1, d, 12));\n    }\n    return arr;\n  };\n  const daysArray = getDaysArray(currentYear, currentMonth);\n\n  const handleDayClick = (dateObj) => {\n    if (!dateObj) return;\n    // Prevent clicking on dates in the future if viewing the current month.\n    const clickedDate = new Date(dateObj);\n    clickedDate.setHours(12, 0, 0, 0);\n    const today = new Date();\n    today.setHours(12, 0, 0, 0);\n    if (currentYear === today.getFullYear() && currentMonth === (today.getMonth() + 1)) {\n      if (clickedDate > today) return;\n    }\n    if (selectedDate && selectedDate.getTime() === dateObj.getTime()) {\n      setIsDayPanelOpen(false);\n      setTimeout(() => setSelectedDate(null), 300);\n    } else {\n      setSelectedDate(dateObj);\n      setIsDayPanelOpen(true);\n    }\n  };\n\n  // When updating a day's status, normalize the date before storing.\n  const handleUpdateStatus = async (status) => {\n    if (!selectedDate || !user?._id) return;\n    const normalizedDate = new Date(selectedDate);\n    normalizedDate.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(normalizedDate);\n    try {\n      const res = await updateDrinkingLog(user._id, key, status);\n      if (res && res.success) {\n        setAllLogs((prev) => {\n          const idx = prev.findIndex((lg) => {\n            const dd = new Date(lg.date);\n            dd.setHours(12, 0, 0, 0);\n            return formatLocalDate(dd) === key;\n          });\n          if (idx >= 0) {\n            const newArr = [...prev];\n            newArr[idx].status = status;\n            return newArr;\n          } else {\n            return [\n              ...prev,\n              { user: user._id, date: normalizedDate, status }\n            ];\n          }\n        });\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      }\n    } catch (err) {\n      console.error(\"Error updating day log:\", err);\n    }\n  };\n\n  const handlePrevMonth = () => {\n    let mo = currentMonth - 1;\n    let yr = currentYear;\n    if (mo < 1) {\n      mo = 12;\n      yr--;\n    }\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n\n  const handleNextMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    let mo = currentMonth + 1;\n    let yr = currentYear;\n    if (mo > 12) {\n      mo = 1;\n      yr++;\n    }\n    if (yr > realY || (yr === realY && mo > realM)) return;\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n\n  const isCurrentMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    return currentYear === realY && currentMonth === realM;\n  };\n\n  return (\n    <div className=\"home-container\">\n      <Navbar onSignOut={() => {\n        localStorage.removeItem('bacshotsUser');\n        window.location.href = '/signin';\n      }} />\n      <div className=\"home-main\">\n        <div className=\"big-profile-container\">\n          {profileUrl ? (\n            <img src={profileUrl} alt=\"Profile\" />\n          ) : (\n            <div className=\"big-profile-initials\">{initials || 'N'}</div>\n          )}\n        </div>\n        <div className=\"greeting dm-sans-semibold\">Hello {firstName}!</div>\n        <div className=\"stats-container\">\n          <div className=\"stats-box dm-sans-semibold\" onClick={() => setWeeklyModalOpen(true)}>\n            <p>Your Weekly <br/> Stats</p>\n            <p className=\"stats-subtext\">{weeklySoberDays} days sober this week</p>\n          </div>\n          <div className=\"stats-box dm-sans-semibold\" onClick={() => setMonthlyModalOpen(true)}>\n            <p>Your Monthly Stats</p>\n            <p className=\"stats-subtext\">{monthsCrashoutFree} crashout‑free months</p>\n          </div>\n          <div className=\"stats-box dm-sans-semibold achievements-box\" onClick={() => setAchievementsModalOpen(true)}>\n            <div className=\"achievements-ring\">\n              <svg className=\"progress-ring\" width=\"120\" height=\"120\">\n                <circle stroke=\"#ccc\" strokeWidth=\"10\" fill=\"transparent\" r={50} cx=\"60\" cy=\"60\" />\n                <circle\n                  stroke=\"#4caf50\"\n                  strokeWidth=\"10\"\n                  fill=\"transparent\"\n                  r={50}\n                  cx=\"60\"\n                  cy=\"60\"\n                  strokeDasharray={`${2 * Math.PI * 50} ${2 * Math.PI * 50}`}\n                  strokeDashoffset={2 * Math.PI * 50 - fraction * (2 * Math.PI * 50)}\n                  style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n                />\n                <text x=\"60\" y=\"66\" textAnchor=\"middle\" fontSize=\"20\" fontWeight=\"bold\" fill=\"#333\">\n                  {unlockedCount}/{totalAchievements}\n                </text>\n              </svg>\n            </div>\n            <p>Achievements</p>\n          </div>\n        </div>\n        <div className=\"calendar-wrapper\">\n          <div className=\"calendar-header\">\n            <button className=\"cal-nav-btn\" onClick={handlePrevMonth}>‹</button>\n            <div className=\"calendar-month-year dm-sans-semibold\">\n              {currentMonth}/{currentYear}\n            </div>\n            {!isCurrentMonth() && (\n              <button className=\"cal-nav-btn\" onClick={handleNextMonth}>›</button>\n            )}\n          </div>\n          <div className=\"calendar-grid day-labels\">\n            {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map((d) => (\n              <div key={d} className=\"day-label\">{d}</div>\n            ))}\n          </div>\n          <div className=\"calendar-grid day-cells\">\n            {daysArray.map((dt, i) => (\n              <div key={i} className={getDayClass(dt)} onClick={() => handleDayClick(dt)}>\n                {dt ? dt.getDate() : ''}\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className={`day-status-panel ${selectedDate && isDayPanelOpen ? 'open' : selectedDate ? 'opening' : 'closing'}`}>\n          {selectedDate && (\n            <div className=\"day-status-buttons\">\n              <button className=\"btn-sober\" onClick={() => handleUpdateStatus('sober')}>I did not drink</button>\n              <button className=\"btn-medium\" onClick={() => handleUpdateStatus('medium')}>I drank a bit</button>\n              <button className=\"btn-heavy\" onClick={() => handleUpdateStatus('heavy')}>I crashed out</button>\n            </div>\n          )}\n        </div>\n      </div>\n      {weeklyModalOpen && (\n        <Modal onClose={() => setWeeklyModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Weekly Stats</h2>\n          <p>You have been sober {weeklySoberDays} days this week!</p>\n          <p>Additional charts can be shown here.</p>\n        </Modal>\n      )}\n      {monthlyModalOpen && (\n        <Modal onClose={() => setMonthlyModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Monthly Stats</h2>\n          <p>You have {monthsCrashoutFree} crashout‑free months in the last 12 months.</p>\n          <p>Additional monthly details can be shown here.</p>\n        </Modal>\n      )}\n      {achievementsModalOpen && (\n        <Modal onClose={() => setAchievementsModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Achievements</h2>\n          <p>\n            Below are your achievements. A <span className=\"achievement-status unlocked\">✓</span> indicates you’ve accomplished it, while a <span className=\"achievement-status locked\">✕</span> indicates you haven’t.\n          </p>\n          <ul className=\"achievement-list\">\n            {achievements.map((ach) => (\n              <li key={ach.key} className=\"achievement-item\">\n                <div>\n                  <strong>{ach.name}</strong> – {ach.description}\n                </div>\n                <div className={`achievement-status ${ach.unlocked ? 'unlocked' : 'locked'}`}>\n                  {ach.unlocked ? '✓' : '✕'}\n                </div>\n              </li>\n            ))}\n          </ul>\n        </Modal>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}